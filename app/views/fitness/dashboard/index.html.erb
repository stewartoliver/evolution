<div class="flex flex-col lg:flex-row">
	<aside class="flex flex-col gap-5 lg:w-1/3 p-5 bg-background-light dark:bg-background-dark text-text-light dark:text-text-dark">
		<div class="flex flex-col tracking-tight leading-tight">
			<div class="text-2xl font-bold uppercase text-primary-500">
				Fitness Dashboard
			</div>
			<div class="text-text-sub text-sm">
				/fitness /dashboard
			</div>
		</div>
		<div class="flex flex-col divide-y divide-border-light dark:divide-border-dark">
			<% sections = [
				{ title: 'Routines', actions: ['New', 'Browse'], new_path: new_fitness_routine_path, browse_path: fitness_routines_path },
				{ title: 'Exercises', actions: ['New', 'Browse'], new_path: new_fitness_exercise_path, browse_path: fitness_exercises_path },
				{ title: 'Log book', actions: ['New', 'Browse'], new_path: new_fitness_log_path, browse_path: fitness_logs_path  },
				] %>

				<% sections.each_with_index do |section, index| %>
				<div class="pb-4 pt-4 <%= 'last:border-b-0' if index == sections.length - 1 %>">
					<h3 class="text-lg font-semibold text-text-light dark:text-text-dark mb-2">
						<%= section[:title] %>
					</h3>
					<div class="flex space-x-2">
						<% if section[:actions].include?('New') %>
						<%= link_to section[:new_path], class: "flex items-center px-3 py-1 text-sm text-white bg-primary-500 rounded hover:bg-primary-600 transition-colors" do %>
						<!-- Plus Icon -->
						<svg class="mr-1" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
							<line x1="12" y1="5" x2="12" y2="19"></line>
							<line x1="5" y1="12" x2="19" y2="12"></line>
						</svg>
						New
						<% end %>
						<% end %>
						<% if section[:actions].include?('Browse') %>
						<%= link_to section[:browse_path], class: "flex items-center px-3 py-1 text-sm text-primary-500 bg-primary-100 rounded hover:bg-primary-200 transition-colors" do %>
						<!-- Browse Icon -->
						<svg class="mr-1" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
							<circle cx="12" cy="12" r="10"></circle>
							<polygon points="16 8 12 12 8 16 12 12 16 8"></polygon>
						</svg>
						Browse
						<% end %>
						<% end %>
					</div>
				</div>
				<% end %>
			</div>
		</aside>
		<main class="flex flex-col gap-6 p-6 bg-background-light dark:bg-background-dark text-text-light dark:text-text-dark w-full lg:w-2/3">
			<section class="space-y-6">
				<div class="flex gap-4 w-full">
					<div class="space-y-6 w-full">
						<div class="flex items-center justify-between">
							<h2 class="text-2xl font-bold text-primary-500">
								Statistics
							</h2>
						</div>
						<div class="grid grid-cols-1 md:grid-cols-3 gap-4">
							<div class="bg-background-card-light dark:bg-background-card-dark rounded-lg shadow-sm hover:shadow-md transition-shadow duration-200 p-6">
								<div class="flex flex-col gap-2">
									<div class="flex items-center justify-between">
										<div class="uppercase text-xs font-medium text-text-sub dark:text-text-sub-dark">
											Workouts This Week
										</div>
										<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="size-5 fill-blue-400">
											<path fill-rule="evenodd" d="M11.47 10.72a.75.75 0 0 1 1.06 0l7.5 7.5a.75.75 0 1 1-1.06 1.06L12 12.31l-6.97 6.97a.75.75 0 0 1-1.06-1.06l7.5-7.5Z" clip-rule="evenodd" />
										</svg>
									</div>
									<div class="text-2xl font-semibold text-text-light dark:text-text-dark">
										<%= @logs_this_week.count %>
									</div>
									<div class="text-xs text-text-sub dark:text-text-sub-dark">
										Last 7 days
									</div>
								</div>
							</div>
							<div class="bg-background-card-light dark:bg-background-card-dark rounded-lg shadow-sm hover:shadow-md transition-shadow duration-200 p-6">
								<div class="flex flex-col gap-2">
									<div class="flex items-center justify-between">
										<div class="uppercase text-xs font-medium text-text-sub dark:text-text-sub-dark">
											Current BMI
										</div>
										<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="size-5 fill-green-400">
											<path fill-rule="evenodd" d="M11.47 10.72a.75.75 0 0 1 1.06 0l7.5 7.5a.75.75 0 1 1-1.06 1.06L12 12.31l-6.97 6.97a.75.75 0 0 1-1.06-1.06l7.5-7.5Z" clip-rule="evenodd" />
										</svg>
									</div>
									<div class="text-2xl font-semibold text-text-light dark:text-text-dark">
										<%= current_user.bmi %>
									</div>
									<div class="text-xs text-text-sub dark:text-text-sub-dark">
										<%= current_user.bmi_status %>
									</div>
								</div>
							</div>
							<div class="bg-background-card-light dark:bg-background-card-dark rounded-lg shadow-sm hover:shadow-md transition-shadow duration-200 p-6">
								<div class="flex flex-col gap-2">
									<div class="flex items-center justify-between">
										<div class="uppercase text-xs font-medium text-text-sub dark:text-text-sub-dark">
											Exercise Streak
										</div>
										<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="size-5 fill-orange-400">
											<path fill-rule="evenodd" d="M11.47 10.72a.75.75 0 0 1 1.06 0l7.5 7.5a.75.75 0 1 1-1.06 1.06L12 12.31l-6.97 6.97a.75.75 0 0 1-1.06-1.06l7.5-7.5Z" clip-rule="evenodd" />
										</svg>
									</div>
									<div class="text-2xl font-semibold text-text-light dark:text-text-dark">
										<%= current_user.current_streak %> days
									</div>
									<div class="text-xs text-text-sub dark:text-text-sub-dark">
										Current streak
									</div>
								</div>
							</div>
						</div>
						<div class="space-y-6 w-full">
							<div class="flex items-center justify-between">
								<h2 class="text-2xl font-bold text-primary-500">
									Recent Logs
								</h2>
								<%= link_to new_fitness_log_path, class: "inline-flex items-center px-3 py-1.5 text-sm text-white bg-primary-500 rounded-md hover:bg-primary-600 transition-colors" do %>
									<svg class="mr-1.5" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
										<line x1="12" y1="5" x2="12" y2="19"></line>
										<line x1="5" y1="12" x2="19" y2="12"></line>
									</svg>
									New Log
								<% end %>
							</div>
							<div class="grid grid-cols-1 md:grid-cols-3 gap-4">
							<% @logs_this_week.each do |log| %>
							  <div class="transaction-card bg-background-card-light dark:bg-background-card-dark rounded-lg shadow-sm hover:shadow-md transition-shadow duration-200">
								<div class="flex items-start justify-between p-6 border-b border-border-light dark:border-border-dark">
								  <div class="flex flex-col text-sm text-text-light dark:text-text-dark">
								 	<div>
								 		<%= time_ago_in_words(log.date) %> ago
									</div>
									<div class="font-semibold text-lg">
									<% if log.routine.present? %>
										<%= log.routine.name %>
									<% else %>
									  	<%= log.majority_type %>
									<% end %>
									</div>
								  </div>
								  <div class="flex items-center gap-2">
									<%= link_to fitness_log_path(log.id), class: "focus:outline-none", title: "View Details" do %>
									  <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="h-5 w-5 text-primary-500 hover:text-primary-600 transition">
										<path stroke-linecap="round" stroke-linejoin="round" d="M3.75 3.75v4.5m0-4.5h4.5m-4.5 0L9 9M3.75 20.25v-4.5m0 4.5h4.5m-4.5 0L9 15M20.25 3.75h-4.5m4.5 0v4.5m0-4.5L15 9m5.25 11.25h-4.5m4.5 0v-4.5m0 4.5L15 15" />
									  </svg>
									<% end %>
								  </div>
								</div>
								
								<div class="p-6 space-y-4">
								  <% if log.fitness_log_exercises.any? %>
									<div>
									  <div class="space-y-2">
										<% log.fitness_log_exercises.limit(2).each do |log_exercise| %>
										  <div class="text-sm text-text-light dark:text-text-dark">
											<div class="flex justify-between font-semibold mb-1">
											  <span><%= log_exercise.exercise.name %></span>
											  <% if log_exercise.fitness_log_sets.any? %>
												<span><%= log_exercise.fitness_log_sets.count %> sets</span>
											  <% else %>
												<span class="text-text-sub dark:text-text-sub-dark">No sets recorded</span>
											  <% end %>
											</div>
											<% if log_exercise.fitness_log_sets.any? %>
											  <div class="space-y-1 text-xs text-text-sub dark:text-text-sub-dark">
												<% log_exercise.fitness_log_sets.each_with_index do |set, index| %>
												  <div class="flex justify-between">
													<span>Set <%= index + 1 %>:</span>
													<span><%= set.reps %> reps @ <%= set.weight %> <%= current_user.weight_unit %></span>
												  </div>
												<% end %>
											  </div>
											<% end %>
										  </div>
										<% end %>
									  </div>
									</div>
								  <% end %>
						  
								  <% if log.notes.present? %>
									<div class="text-sm text-text-sub dark:text-text-sub-dark">
									  <strong>Notes:</strong> <%= log.notes %>
									</div>
								  <% end %>
								</div>
							  </div>
							<% end %>
						  </div>
						</div>
					</div>
				</div>
			</section>
			<section class="space-y-6">
				<div class="flex items-center justify-between">
					<h2 class="text-2xl font-bold text-primary-500">
						Upcoming Workouts
					</h2>
					<%= link_to new_fitness_routine_path, class: "inline-flex items-center px-3 py-1.5 text-sm text-white bg-primary-500 rounded-md hover:bg-primary-600 transition-colors" do %>
						<svg class="mr-1.5" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
							<line x1="12" y1="5" x2="12" y2="19"></line>
							<line x1="5" y1="12" x2="19" y2="12"></line>
						</svg>
						New Routine
					<% end %>
				</div>
				<div class="grid grid-cols-1 md:grid-cols-2 gap-4">
					<% current_user.routines.each do |routine| %>
					<div class="transaction-card bg-background-card-light dark:bg-background-card-dark rounded-lg shadow-sm hover:shadow-md transition-shadow duration-200">
						<div class="flex items-start justify-between p-6 border-b border-border-light dark:border-border-dark">
							<div>
								<p class="text-sm text-text-sub dark:text-text-sub-dark mb-1">
									<%= pluralize(routine.routine_exercises.count, 'exercise') %>
								</p>
								<h3 class="text-2xl font-semibold text-text-light dark:text-text-dark">
									<%= routine.name %>
								</h3>
							</div>
							<div class="flex items-center gap-2">
								<%= link_to fitness_routine_path(routine.id), class: "focus:outline-none", title: "View Details" do %>
									<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="h-5 w-5 text-primary-500 hover:text-primary-600 transition">
										<path stroke-linecap="round" stroke-linejoin="round" d="M3.75 3.75v4.5m0-4.5h4.5m-4.5 0L9 9M3.75 20.25v-4.5m0 4.5h4.5m-4.5 0L9 15M20.25 3.75h-4.5m4.5 0v4.5m0-4.5L15 9m5.25 11.25h-4.5m4.5 0v-4.5m0 4.5L15 15" />
									</svg>
								<% end %>
							</div>
						</div>
						<div class="p-6 space-y-4">
							<% if routine.description.present? %>
								<div class="text-sm text-text-sub dark:text-text-sub-dark">
									<%= routine.description %>
								</div>
							<% end %>
							<div class="flex justify-between items-center">
								<div class="text-sm font-medium text-primary-500">
								<% if routine.last_used_at.present? %>
								Last used: <%= routine.last_used_at.strftime("%b %d, %Y, %H:%M") %>
							 	<% else %>
								Last used: Never
							  	<% end %>
								</div>
								<div class="text-sm text-text-sub dark:text-text-sub-dark">
									<%= pluralize(routine.routine_exercises.count, 'exercise') %>
								</div>
							</div>
						</div>
					</div>
					<% end %>
				</div>
			</section>
		</main>
	</div>